pipeline {
	agent any

	triggers {
		pollSCM('* * * * *')
	}

	stages {
		stage('Build') {
			steps {
				echo '========================1. Build ====================='
			}
		}
		stage('Deploy'){
			parallel{
				stage('Deploy App'){
					steps{
						echo '====================2 Deploy ========================='
						sh "cp -R /sorc001/applications/ciserv/jenkins/workspace/HongsExchange_pipeline /sorc001/applications"
						sh "rm -rf /sorc001/applications/mainWebApp.war"
						sh "mv /sorc001/applications/HongsExchange_pipeline /sorc001/applications/mainWebApp.war"

					}
				}
				stage('Restart Server'){
				   sh "/engn001/tomcat/9.0/servers/ist_8180/stop.sh"
				   echo '====================3. Shutdown Server ========================='
				   sh "/engn001/tomcat/9.0/servers/ist_8180/start.sh"
				    echo '====================3. Start Server ========================='
				}

			}
		}
	}
}